ğŸ”§ 1. KoNLP íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ì¤€ë¹„
# 1-1. Java ë° rJava ì„¤ì¹˜ (JDK í•„ìš”)
install.packages("multilinguer")  # JDK ìë™ ì„¤ì¹˜ ë„êµ¬
library(multilinguer)
install_jdk()

# 1-2. KoNLP ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ì„¤ì¹˜
install.packages(c("stringr", "hash", "tau", "Sejong", "RSQLite", "devtools"), type = "binary")

# 1-3. KoNLP ì„¤ì¹˜ ë° ë¡œë”©
install.packages("remotes")
remotes::install_github("haven-jeon/KoNLP", upgrade = "never", INSTALL_opts = c("--no-multiarch"))
library(KoNLP)

# 1-4. í˜•íƒœì†Œ ë¶„ì„ìš© ì‚¬ì „ ì„¤ì • (NIA ì‚¬ì „ ì‚¬ìš©)
useNIADic()

ğŸ¤ 2. í…ìŠ¤íŠ¸ ë§ˆì´ë‹ ì‹¤ìŠµ: í™í•© ê°€ì‚¬ ë¶„ì„
# 2-1. í…ìŠ¤íŠ¸ íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
txt <- readLines("C:/Users/sonhy/OneDrive/ë°”íƒ• í™”ë©´/ì½”ë”©/R/ë°ì´í„° ë¶„ì„/hiphop.txt")

# 2-2. íŠ¹ìˆ˜ë¬¸ì ì œê±°
library(stringr)
txt <- str_replace_all(txt, "\\W", " ")  # \WëŠ” ì˜ë¬¸ì/ìˆ«ì/í•œê¸€ ì´ì™¸ì˜ ë¬¸ì ì œê±°

# 2-3. ëª…ì‚¬ ì¶”ì¶œ ë° ë¹ˆë„ ê³„ì‚°
nouns <- extractNoun(txt)                        # ëª…ì‚¬ë§Œ ì¶”ì¶œ
wordcount <- table(unlist(nouns))               # ë¦¬ìŠ¤íŠ¸ë¥¼ ë²¡í„°ë¡œ í’€ê³  ë¹ˆë„í‘œ ìƒì„±
df_word <- as.data.frame(wordcount, stringsAsFactors = FALSE)
df_word <- rename(df_word, word = Var1, freq = Freq)
df_word <- filter(df_word, nchar(word) >= 2)     # 2ê¸€ì ì´ìƒë§Œ ì¶”ì¶œ

# 2-4. ìƒìœ„ 20ê°œ ë‹¨ì–´ ì¶”ì¶œ
top_20 <- df_word %>% arrange(desc(freq)) %>% head(20)

â˜ï¸ 3. ì›Œë“œ í´ë¼ìš°ë“œ ì‹œê°í™”
install.packages("wordcloud")
library(wordcloud)
library(RColorBrewer)

pal <- brewer.pal(8, "Dark2")  # ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ì„¤ì •
set.seed(1234)                 # ì¬í˜„ì„±ì„ ìœ„í•œ ì‹œë“œ ì„¤ì •

wordcloud(words = df_word$word,
          freq = df_word$freq,
          min.freq = 2,
          max.words = 200,
          random.order = FALSE,
          rot.per = 0.1,
          scale = c(4, 0.3),
          colors = pal)

ğŸ¦ 4. êµ­ì •ì› íŠ¸ìœ— í…ìŠ¤íŠ¸ ë§ˆì´ë‹
# 4-1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë° ì „ì²˜ë¦¬
twitter <- read.csv("twitter.csv", header = TRUE, fileEncoding = "UTF-8")
twitter <- rename(twitter, no = ë²ˆí˜¸, id = ê³„ì •ì´ë¦„, date = ì‘ì„±ì¼, tw = ë‚´ìš©)
twitter$tw <- str_replace_all(twitter$tw, "\\w", " ")  # ì˜ìˆ«ì ì œê±°

# 4-2. ëª…ì‚¬ ì¶”ì¶œ ë° ë¹ˆë„ ë¶„ì„
nouns <- extractNoun(twitter$tw)
wordcount <- table(unlist(nouns))
df_word <- as.data.frame(wordcount)
df_word <- rename(df_word, word = Var1, freq = Freq)
df_word <- filter(df_word, nchar(word) >= 2)

# 4-3. ìƒìœ„ 20ê°œ ë‹¨ì–´ ì¶”ì¶œ ë° ë§‰ëŒ€ê·¸ë˜í”„ ì‹œê°í™”
top20 <- df_word %>% arrange(desc(freq)) %>% head(20)
library(ggplot2)
order <- arrange(top20, freq)$word

ggplot(data = top20, aes(x = word, y = freq)) +
  ylim(0, 2500) +
  geom_col() +
  coord_flip() +
  scale_x_discrete(limit = order) +
  geom_text(aes(label = freq), hjust = 0.1)

ğŸŒ 5. íŠ¸ìœ— ì›Œë“œ í´ë¼ìš°ë“œ ì‹œê°í™”
pal <- brewer.pal(9, "Blues")[5:9]
set.seed(1234)

wordcloud(word = df_word$word,
          freq = df_word$freq,
          min.freq = 10,
          max.words = 150,
          random.order = FALSE,
          rot.per = 0,
          scale = c(6, 0.5),
          colors = pal)

ğŸ“Œ ì°¸ê³  ì‚¬í•­
useNIADic()ì„ ì‹¤í–‰í•˜ë©´ ì²˜ìŒì—ëŠ” ì‹œê°„ì´ ë‹¤ì†Œ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
KoNLPëŠ” Java ê¸°ë°˜ì´ë¼, JDK ë²„ì „ê³¼ rJava ì„¤ì¹˜ ì—¬ë¶€ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.
str_replace_all(txt, "\\w", " ")ëŠ” í•œê¸€ ë‹¨ì–´ë¥¼ ì œê±°í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì¼ë°˜ì ìœ¼ë¡œëŠ” \\W ë˜ëŠ” [^ê°€-í£] ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
