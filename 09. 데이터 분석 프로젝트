ğŸ“Š êµ­ë¯¼ë³µì§€íŒ¨ë„ ë°ì´í„° ë¶„ì„ ìš”ì•½ ì •ë¦¬
ğŸ“¦ 1. íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
install.packages("foreign")
library(foreign); library(dplyr); library(ggplot2); library(readxl)

raw_welfare <- read.spss("koweps_hpc10_2015_beta1.sav", to.data.frame = T)
welfare <- raw_welfare

.sav(SPSS) íŒŒì¼ì„ Rì—ì„œ ë¶ˆëŸ¬ì˜´

ğŸ§¾ 2. ë°ì´í„° êµ¬ì¡° íŒŒì•…
head(welfare); tail(welfare); View(welfare)
dim(welfare); str(welfare); summary(welfare)

ë°ì´í„°ì˜ í¬ê¸°, ë³€ìˆ˜ êµ¬ì¡°, ìš”ì•½í†µê³„ í™•ì¸

ğŸ·ï¸ 3. ë³€ìˆ˜ëª… ë³€ê²½
welfare <- rename(welfare,
  sex = h10_g3, birth = h10_g4, marriage = h10_g10,
  religion = h10_g11, income = p1002_8aq1,
  code_job = h10_eco9, code_region = h10_reg7)

ì½”ë“œë¡œ ë˜ì–´ ìˆëŠ” ë³€ìˆ˜ëª…ì„ ì˜ë¯¸ ìˆëŠ” ì´ë¦„ìœ¼ë¡œ ë°”ê¿ˆ

ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ 4. ì„±ë³„ ë³€ìˆ˜ ì „ì²˜ë¦¬
welfare$sex <- ifelse(welfare$sex == 9, NA, welfare$sex)
welfare$sex <- ifelse(welfare$sex == 1, "male", "female")

ì´ìƒì¹˜ 9 â†’ NA
1: ë‚¨ì„±, 2: ì—¬ì„± â†’ ë¬¸ìí˜•ìœ¼ë¡œ ë³€í™˜

ğŸ’° 5. ì›”ê¸‰ ë³€ìˆ˜ ì „ì²˜ë¦¬
summary(welfare$income)
qplot(welfare$income) + xlim(0, 1000)

welfare$income <- ifelse(welfare$income %in% c(0, 9999), NA, welfare$income)

0, 9999ëŠ” ì›”ê¸‰ ì—†ìŒ í˜¹ì€ ì´ìƒê°’ â†’ NA ì²˜ë¦¬
ì›”ê¸‰ ë¶„í¬ ì‹œê°í™”

ğŸ“ˆ 6. ì„±ë³„ì— ë”°ë¥¸ ì›”ê¸‰ ì°¨ì´
sex_income <- welfare %>%
  filter(!is.na(income)) %>%
  group_by(sex) %>%
  summarise(mean_income = mean(income))

ggplot(sex_income, aes(x = sex, y = mean_income)) +
  geom_col()

ğŸ‚ 7. ë‚˜ì´ ë³€ìˆ˜ ìƒì„± ë° ì „ì²˜ë¦¬
welfare$birth <- ifelse(welfare$birth == 9999, NA, welfare$birth)
welfare$age <- 2015 - welfare$birth + 1
qplot(welfare$age)

ì¶œìƒì—°ë„ â†’ ë‚˜ì´ ê³„ì‚°
9999ëŠ” ê²°ì¸¡ â†’ NA ì²˜ë¦¬

ğŸ“‰ 8. ë‚˜ì´ì™€ ì›”ê¸‰ ê´€ê³„
age_income <- welfare %>%
  filter(!is.na(income)) %>%
  group_by(age) %>%
  summarise(mean_income = mean(income))

ggplot(age_income, aes(x = age, y = mean_income)) +
  geom_line()

ë‚˜ì´ë³„ ì›”ê¸‰ í‰ê·  ì¶”ì„¸ (ê³¡ì„  í˜•íƒœë¡œ ë³€í™”)

ğŸ‘¥ 9. ì—°ë ¹ëŒ€ íŒŒìƒ ë³€ìˆ˜ ìƒì„± ë° ë¶„ì„
welfare <- welfare %>%
  mutate(ageg = ifelse(age < 30, "young",
                       ifelse(age <= 59, "middle", "old")))

ageg_income <- welfare %>%
  filter(!is.na(income)) %>%
  group_by(ageg) %>%
  summarise(mean_income = mean(income))

ggplot(ageg_income, aes(x = ageg, y = mean_income)) +
  geom_col() +
  scale_x_discrete(limits = c("young", "middle", "old"))

young/middle/old ì„¸ ì—°ë ¹ëŒ€ êµ¬ë¶„
ì—°ë ¹ëŒ€ë³„ ì›”ê¸‰ ë¹„êµ

ğŸ“Š 10. ì—°ë ¹ëŒ€ ë° ì„±ë³„ ì›”ê¸‰ ì°¨ì´
sex_income <- welfare %>%
  filter(!is.na(income)) %>%
  group_by(ageg, sex) %>%
  summarise(mean_income = mean(income))

ggplot(sex_income, aes(x = ageg, y = mean_income, fill = sex)) +
  geom_col(position = "dodge") +
  scale_x_discrete(limits = c("young", "middle", "old"))

ğŸ‘” 11. ì§ì—…ë³„ ì›”ê¸‰ ì°¨ì´
job_income <- welfare %>%
  filter(!is.na(job) & !is.na(income)) %>%
  group_by(job) %>%
  summarise(mean_income = mean(income))

top10 <- job_income %>%
  arrange(desc(mean_income)) %>%
  head(10)

ggplot(top10, aes(x = reorder(job, mean_income), y = mean_income)) +
  geom_col() +
  coord_flip()

ì§ì—…ë³„ ì›”ê¸‰ í‰ê·  ìƒìœ„ 10ê°œ ì§ì—… ì‹œê°í™” (ë§‰ëŒ€ + íšŒì „)

ğŸ§‘â€ğŸ”§ 12. ì„±ë³„ ì§ì—… ë¹ˆë„
job_male <- welfare %>%
  filter(!is.na(job) & sex == "male") %>%
  group_by(job) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) %>%
  head(10)

ggplot(job_male, aes(x = reorder(job, n), y = n)) +
  geom_col() +
  coord_flip()

ë‚¨ì„± ê¸°ì¤€ ë¹ˆë„ìˆ˜ ë†’ì€ ì§ì—… Top 10

â›ª 13. ì¢…êµ ìœ ë¬´ì— ë”°ë¥¸ ì´í˜¼ìœ¨
religion_marriage <- welfare %>%
  filter(!is.na(group_marriage)) %>%
  count(religion, group_marriage) %>%
  group_by(religion) %>%
  mutate(pct = round(n / sum(n) * 100, 1))

ggplot(religion_marriage, aes(x = ageg, y = pct, fill = religion)) +
  geom_col(position = "dodge")

ì¢…êµ ìœ ë¬´ì— ë”°ë¥¸ ì´í˜¼ ë¹„ìœ¨ ì‹œê°í™”
â€» group_marriageëŠ” ë¯¸ë¦¬ ìƒì„±ë˜ì–´ ìˆì–´ì•¼ í•¨

ğŸ˜ï¸ 14. ì§€ì—­ë³„ ì—°ë ¹ëŒ€ ë¹„ìœ¨
# ì •ë ¬ ìˆœì„œ ì§€ì •
list_order_old <- region_ageg %>%
  filter(ageg == "old") %>%
  arrange(pct)
order <- list_order_old$region

# ageg ìˆœì„œ ì§€ì •
region_ageg$ageg <- factor(region_ageg$ageg,
                           level = c("old", "middle", "young"))

# ì‹œê°í™”
ggplot(region_ageg, aes(x = region, y = pct, fill = ageg)) +
  geom_col() +
  coord_flip() +
  scale_x_discrete(limits = order)

ì§€ì—­ë³„ ê³ ë ¹ì ë¹„ìœ¨ ìˆœìœ¼ë¡œ ì •ë ¬
ê° ì§€ì—­ì—ì„œ ì—°ë ¹ëŒ€ ë¹„ìœ¨ ë¹„êµ ê°€ëŠ¥
